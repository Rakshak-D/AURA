<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AURA - AI Assistant</title>
    <link rel="stylesheet" href="/static/css/styles.css?v=4">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
</head>

<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="brand">
                <div class="logo-circle">A</div>
                <h1>AURA</h1>
            </div>

            <div class="search-container" style="padding: 0 1rem; margin-bottom: 1rem;">
                <div class="search-box"
                    style="background: var(--bg-secondary); padding: 8px; border-radius: 8px; display: flex; align-items: center;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        style="opacity: 0.7;">
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                    </svg>
                    <input type="text" id="global-search" placeholder="Search..."
                        style="background: transparent; border: none; color: var(--text-primary); margin-left: 8px; width: 100%; outline: none;"
                        onkeydown="if(event.key === 'Enter') performGlobalSearch(this.value)">
                </div>
            </div>

            <nav class="nav-menu">
                <button class="nav-item active" data-view="chat">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />
                    </svg>
                    <span>Chat</span>
                </button>
                <button class="nav-item" data-view="tasks">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 11l3 3L22 4" />
                        <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11" />
                    </svg>
                    <span>Tasks</span>
                </button>
                <button class="nav-item" data-view="calendar">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
                        <line x1="16" y1="2" x2="16" y2="6" />
                        <line x1="8" y1="2" x2="8" y2="6" />
                        <line x1="3" y1="10" x2="21" y2="10" />
                    </svg>
                    <span>Calendar</span>
                </button>
                <button class="nav-item" data-view="upload">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z" />
                        <polyline points="13 2 13 9 20 9" />
                    </svg>
                    <span>Knowledge</span>
                </button>
                <button class="nav-item" data-view="analytics">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="20" x2="12" y2="10" />
                        <line x1="18" y1="20" x2="18" y2="4" />
                        <line x1="6" y1="20" x2="6" y2="16" />
                    </svg>
                    <span>Insights</span>
                </button>
            </nav>

            <div class="sidebar-footer">
                <button class="settings-btn" onclick="openSettings()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3" />
                        <path
                            d="M12 1v6m0 6v6m5.657-17.657L15.464 8.536m0 6.928l2.193 2.193M23 12h-6m-6 0H1m17.657 5.657l-7.071-7.071m0-6.93l-2.193-2.192M1 12l6 0m-6-5.657l2.193 2.193m0 6.928l-2.193 2.193" />
                    </svg>
                    <span>Settings</span>
                </button>
                <div class="user-profile" onclick="openSettings()" title="Open Settings">
                    <div class="avatar">R</div>
                    <div class="user-info">
                        <span class="name">Rakshak</span>
                        <span class="status">Online</span>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Chat View -->
            <div id="chat-view" class="view active">
                <div class="chat-interface">
                    <div id="chat-history" class="chat-history">
                        <div class="welcome-section">
                            <div class="aura-avatar">
                                <div class="avatar-glow"></div>
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none">
                                    <circle cx="12" cy="12" r="10" stroke="url(#grad1)" stroke-width="2" />
                                    <path d="M12 8v8m-4-4h8" stroke="url(#grad1)" stroke-width="2"
                                        stroke-linecap="round" />
                                    <defs>
                                        <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="100%">
                                            <stop offset="0%" style="stop-color:#4facfe;stop-opacity:1" />
                                            <stop offset="100%" style="stop-color:#00f2fe;stop-opacity:1" />
                                        </linearGradient>
                                    </defs>
                                </svg>
                            </div>
                            <h2>Good evening, <span id="welcome-name">Rakshak</span></h2>
                            <p class="subtitle">How can I assist you today?</p>

                            <div class="suggestions-container">
                                <button class="suggestion-chip"
                                    onclick="setChatInput('What is my schedule for today?')">üìÖ My Schedule</button>
                                <button class="suggestion-chip"
                                    onclick="setChatInput('Create a task to study Physics at 6 PM')">‚ú® New Task</button>
                                <button class="suggestion-chip"
                                    onclick="setChatInput('Show me my productivity insights')">üìä Insights</button>
                                <button class="suggestion-chip"
                                    onclick="setChatInput('Search for notes on Quantum Mechanics')">üîç Search</button>
                            </div>
                        </div>
                    </div>

                    <div class="input-area">
                        <div class="input-container">
                            <button id="upload-btn-mini" class="icon-btn" title="Upload file"
                                onclick="document.getElementById('chat-file-input').click()">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path
                                        d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48" />
                                </svg>
                            </button>
                            <input type="file" id="chat-file-input" hidden accept=".pdf,.txt,.docx"
                                onchange="handleChatFileUpload(event)">
                            <textarea id="chat-input" placeholder="Ask me anything..." rows="1"
                                onkeydown="handleChatInput(event)"></textarea>
                            <button id="voice-btn" class="icon-btn voice-btn" title="Voice Input">
                                <div class="mic-icon">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z" />
                                        <path d="M19 10v2a7 7 0 0 1-14 0v-2" />
                                        <line x1="12" y1="19" x2="12" y2="23" />
                                        <line x1="8" y1="23" x2="16" y2="23" />
                                    </svg>
                                </div>
                                <div class="voice-waves">
                                    <span></span><span></span><span></span>
                                </div>
                            </button>
                            <button id="send-btn" class="send-btn" onclick="sendMessage()">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <line x1="22" y1="2" x2="11" y2="13" />
                                    <polygon points="22 2 15 22 11 13 2 9 22 2" />
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tasks View -->
            <!-- Calendar View -->
            <div id="calendar-view" class="view">
                <div class="view-header">
                    <h2>Calendar</h2>
                    <div class="calendar-nav">
                        <button onclick="previousMonth()" class="icon-btn">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <polyline points="15 18 9 12 15 6" />
                            </svg>
                        </button>
                        <span id="current-month" class="font-semibold"></span>
                        <button onclick="nextMonth()" class="icon-btn">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <polyline points="9 18 15 12 9 6" />
                            </svg>
                        </button>
                    </div>
                </div>
                <div id="calendar-grid" class="calendar-container"></div>
            </div>

            <!-- Upload/Knowledge View -->
            <div id="upload-view" class="view">
                <div class="view-header">
                    <div>
                        <h2>Knowledge Base</h2>
                        <p class="subtitle">Enhance AURA's understanding with your documents</p>
                    </div>
                </div>
                <div class="upload-layout">
                    <div class="upload-zone" id="drop-zone">
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="1.5">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                            <polyline points="17 8 12 3 7 8" />
                            <line x1="12" y1="3" x2="12" y2="15" />
                        </svg>
                        <h3>Drop files here or browse</h3>
                        <p>PDF, TXT, DOCX supported</p>
                        <input type="file" id="file-input" hidden multiple onchange="handleFileSelect(event)">
                        <button class="btn-secondary" onclick="document.getElementById('file-input').click()">Browse
                            Files</button>
                    </div>
                    <div class="files-sidebar">
                        <h3>Learned Documents</h3>
                        <div id="files-list" class="files-list"></div>
                    </div>
                </div>
            </div>

            <!-- Analytics View -->
            <div id="analytics-view" class="view">
                <div class="view-header">
                    <h2>Analytics</h2>
                    <p class="subtitle">Track your productivity</p>
                </div>
                <div class="analytics-container" style="padding: 30px; overflow-y: auto; height: calc(100% - 80px);">
                    <div class="stats-grid"
                        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
                        <div class="stat-card"
                            style="background: var(--bg-tertiary); padding: 20px; border-radius: var(--radius-md); border: 1px solid var(--border-color);">
                            <div class="stat-icon" style="font-size: 24px; margin-bottom: 10px;">‚úÖ</div>
                            <div class="stat-value" id="total-completed"
                                style="font-size: 32px; font-weight: 700; color: var(--accent-primary);">0</div>
                            <div class="stat-label" style="color: var(--text-secondary);">Completed Tasks</div>
                        </div>
                        <div class="stat-card"
                            style="background: var(--bg-tertiary); padding: 20px; border-radius: var(--radius-md); border: 1px solid var(--border-color);">
                            <div class="stat-icon" style="font-size: 24px; margin-bottom: 10px;">üìà</div>
                            <div class="stat-value" id="completion-rate"
                                style="font-size: 32px; font-weight: 700; color: var(--accent-secondary);">0%
                            </div>
                            <div class="stat-label" style="color: var(--text-secondary);">Success Rate</div>
                        </div>
                        <div class="stat-card"
                            style="background: var(--bg-tertiary); padding: 20px; border-radius: var(--radius-md); border: 1px solid var(--border-color);">
                            <div class="stat-icon" style="font-size: 24px; margin-bottom: 10px;">üìä</div>
                            <div class="stat-value" id="daily-average"
                                style="font-size: 32px; font-weight: 700; color: var(--accent-purple);">0</div>
                            <div class="stat-label" style="color: var(--text-secondary);">Daily Average</div>
                        </div>
                        <div class="stat-card"
                            style="background: var(--bg-tertiary); padding: 20px; border-radius: var(--radius-md); border: 1px solid var(--border-color);">
                            <div class="stat-icon" style="font-size: 24px; margin-bottom: 10px;">üéØ</div>
                            <div class="stat-value" id="total-created"
                                style="font-size: 32px; font-weight: 700; color: var(--text-primary);">0</div>
                            <div class="stat-label" style="color: var(--text-secondary);">Total Created</div>
                        </div>
                    </div>

                    <div class="charts-grid"
                        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px;">
                        <div class="chart-card"
                            style="background: var(--bg-tertiary); padding: 20px; border-radius: var(--radius-md); border: 1px solid var(--border-color);">
                            <h3 style="margin-bottom: 20px; color: var(--text-primary);">Activity (Last 7 Days)
                            </h3>
                            <div id="activity-chart" style="width: 100%; height: 200px;"></div>
                        </div>
                        <div class="chart-card"
                            style="background: var(--bg-tertiary); padding: 20px; border-radius: var(--radius-md); border: 1px solid var(--border-color);">
                            <h3 style="margin-bottom: 20px; color: var(--text-primary);">Priority Breakdown</h3>
                            <div id="priority-chart" style="width: 100%; height: 200px;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal">
        <div class="modal-overlay" onclick="closeSettings()"></div>
        <div class="modal-content settings-panel">
            <div class="modal-header">
                <h2>Settings</h2>
                <button class="icon-btn" onclick="closeSettings()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18" />
                        <line x1="6" y1="6" x2="18" y2="18" />
                    </svg>
                </button>
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    style="margin-right: 8px;">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="7 10 12 15 17 10"></polyline>
                    <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
                Export All Data
                </button>
            </div>
        </div>
    </div>
    </div>
    </div>

    <!-- Task Modal -->
    <div id="task-modal" class="modal">
        <div class="modal-overlay" onclick="closeTaskModal()"></div>
        <div class="modal-content task-panel">
            <div class="modal-header">
                <h2>New Task</h2>
                <button class="icon-btn" onclick="closeTaskModal()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18" />
                        <line x1="6" y1="6" x2="18" y2="18" />
                    </svg>
                </button>
            </div>
            <input type="text" id="task-title" placeholder="What needs to be done?" class="modal-input">
            <textarea id="task-description" placeholder="Details..." class="modal-input" rows="3"></textarea>
            <input type="datetime-local" id="task-due-date" class="modal-input">
            <select id="task-priority" class="modal-input">
                <option value="low">Low Priority</option>
                <option value="medium" selected>Medium Priority</option>
                <option value="high">High Priority</option>
                <option value="urgent">Urgent</option>
            </select>
            <div class="modal-actions">
                <button onclick="closeTaskModal()" class="btn-secondary">Cancel</button>
                <button onclick="saveTask()" class="btn-primary">Save Task</button>
            </div>
        </div>
    </div>

    <!-- Search Modal -->
    <div id="search-modal" class="modal">
        <div class="modal-overlay" onclick="closeSearchModal()"></div>
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2>Search Results</h2>
                <button class="icon-btn" onclick="closeSearchModal()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18" />
                        <line x1="6" y1="6" x2="18" y2="18" />
                    </svg>
                </button>
            </div>
            <div id="search-results" style="max-height: 400px; overflow-y: auto; padding: 1rem;">
                <!-- Results will be injected here -->
            </div>
        </div>
    </div>

    <div id="toast" class="toast"></div>

    <!-- Scripts - main.js MUST load first -->
    <script src="/static/js/main.js"></script>
    <script src="/static/js/chat.js"></script>
    <script src="/static/js/tasks.js"></script>
    <script src="/static/js/calendar.js"></script>
    <script src="/static/js/analytics.js"></script>
    <script src="/static/js/voice.js"></script>
    <script src="/static/js/upload.js"></script>
    <script src="/static/js/settings.js"></script>
    <script src="/static/js/search.js"></script>
    <script src="/static/js/keyboard.js"></script>
</body>

</html>